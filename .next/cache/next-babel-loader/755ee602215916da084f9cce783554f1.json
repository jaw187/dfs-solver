{"ast":null,"code":"var _jsxFileName = \"/Users/jwesto1/Code/jaw187/dfs-solver/components/generator.js\";\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport Card from './card';\nimport { useSelector, useDispatch, shallowEqual } from \"react-redux\";\nimport Solver from \"../solver/index\";\nimport OwnershipWatcher from '../solver/ownership';\nimport clone from 'lodash/clone';\nvar Models = Solver.Models,\n    players = Solver.players,\n    Worker = Solver.Worker;\n\nvar getState = function getState() {\n  var dispatch = useDispatch();\n  var stacks = useSelector(function (state) {\n    return state.stacks;\n  }, shallowEqual);\n  var stackCounts = useSelector(function (state) {\n    return state.stackCounts;\n  }, shallowEqual);\n  var slates = useSelector(function (state) {\n    return state.slates;\n  }, shallowEqual);\n  var selectedSlate = useSelector(function (state) {\n    return state.selectedSlate;\n  });\n  var projection = useSelector(function (state) {\n    return state.projection;\n  });\n  var results = useSelector(function (state) {\n    return state.results;\n  });\n  var pool = useSelector(function (state) {\n    return state.pool;\n  });\n  var view = useSelector(function (state) {\n    return state.view;\n  });\n\n  var addResults = function addResults(results) {\n    dispatch({\n      type: 'ADD_RESULT',\n      payload: results\n    });\n  };\n\n  return {\n    stacks: stacks,\n    stackCounts: stackCounts,\n    slates: slates,\n    selectedSlate: selectedSlate,\n    projection: projection,\n    addResults: addResults,\n    results: results,\n    pool: pool,\n    view: view\n  };\n};\n\nvar Generator = function Generator() {\n  var _getState = getState(),\n      stacks = _getState.stacks,\n      stackCounts = _getState.stackCounts,\n      slates = _getState.slates,\n      selectedSlate = _getState.selectedSlate,\n      projection = _getState.projection,\n      addResults = _getState.addResults,\n      results = _getState.results,\n      pool = _getState.pool,\n      view = _getState.view;\n\n  if (view !== 'generator') {\n    return null;\n  }\n\n  if (!projection || stacks.length === 0) {\n    var issues = [];\n\n    if (stacks.length === 0) {\n      issues.push(__jsx(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 61\n        },\n        __self: this\n      }, \"You need to create stacks first\"));\n    }\n\n    if (!projection) {\n      issues.push(__jsx(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 65\n        },\n        __self: this\n      }, \"You need to import projections first\"));\n    }\n\n    return __jsx(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 69\n      },\n      __self: this\n    }, issues.map(function (issue) {\n      return __jsx(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 70\n        },\n        __self: this\n      }, issue);\n    }));\n  }\n\n  var slate = slates && slates[selectedSlate];\n  var sport = slate.Sport.toLowerCase();\n  var site = 'draftkings';\n  var type = slate.GameType.Name.toLowerCase();\n\n  var generate = function generate() {\n    var playersForModel = players.convertPlayers(pool, projection, sport, site, type);\n    var n = 0;\n    stackCounts.forEach(function (count) {\n      n = n + count;\n    });\n    var worker = new Worker();\n    stacks.forEach(function (stack, i) {\n      var stackPlayers = clone(playersForModel);\n      var model = Models[sport][site][type](stackPlayers); // Force players in stack into lineup\n\n      stack.forEach(function (player) {\n        return model.constraints[player.draftableId] = {\n          equal: 1\n        };\n      });\n      var ownershipOptions = {\n        players: stackPlayers,\n        n: stackCounts[i],\n        stack: stack\n      };\n      worker.postMessage({\n        action: 'ownership',\n        options: ownershipOptions\n      });\n      var enqueueOptions = {\n        action: 'enqueue',\n        n: stackCounts[i],\n        maxIterations: 500,\n        model: model,\n        players: stackPlayers,\n        sport: sport,\n        site: site,\n        type: type\n      };\n      worker.postMessage(enqueueOptions);\n    });\n    worker.postMessage({\n      action: 'solve'\n    });\n    worker.addEventListener('message', function (event) {\n      var results = event.data;\n\n      if (results.length) {\n        addResults(results);\n      }\n    });\n  };\n\n  var formatPlayer = function formatPlayer(draftableId) {\n    var player = slate.players.find(function (player) {\n      return player.draftableId == draftableId;\n    });\n\n    if (!player) {\n      return draftableId;\n    }\n\n    return \"\".concat(player.position, \" - \").concat(player.displayName, \" - \").concat(player.salary);\n  };\n\n  return __jsx(Card, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131\n    },\n    __self: this\n  }, __jsx(\"h2\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132\n    },\n    __self: this\n  }, \"Generator\"), __jsx(\"button\", {\n    onClick: generate,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133\n    },\n    __self: this\n  }, \"Generateee\"), __jsx(\"ul\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134\n    },\n    __self: this\n  }, stacks.map(function (stack, i) {\n    return __jsx(\"li\", {\n      key: i,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 137\n      },\n      __self: this\n    }, \"Stack with \", stackCounts[i], \" lineups\");\n  })));\n};\n\nexport default Generator;","map":{"version":3,"sources":["/Users/jwesto1/Code/jaw187/dfs-solver/components/generator.js"],"names":["Card","useSelector","useDispatch","shallowEqual","Solver","OwnershipWatcher","clone","Models","players","Worker","getState","dispatch","stacks","state","stackCounts","slates","selectedSlate","projection","results","pool","view","addResults","type","payload","Generator","length","issues","push","map","issue","slate","sport","Sport","toLowerCase","site","GameType","Name","generate","playersForModel","convertPlayers","n","forEach","count","worker","stack","i","stackPlayers","model","player","constraints","draftableId","equal","ownershipOptions","postMessage","action","options","enqueueOptions","maxIterations","addEventListener","event","data","formatPlayer","find","position","displayName","salary"],"mappings":"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","sourcesContent":["import Card from './card';\nimport { useSelector, useDispatch, shallowEqual } from \"react-redux\";\nimport Solver from \"../solver/index\";\nimport OwnershipWatcher from '../solver/ownership';\nimport clone from 'lodash/clone';\n\nconst { Models, players, Worker } = Solver;\n\nconst getState = () => {\n  const dispatch = useDispatch();\n\n  const stacks = useSelector(state => state.stacks, shallowEqual);\n  const stackCounts = useSelector(state => state.stackCounts, shallowEqual);\n  const slates = useSelector(state => state.slates, shallowEqual);\n  const selectedSlate = useSelector(state => state.selectedSlate);\n  const projection = useSelector(state => state.projection);\n  const results = useSelector(state => state.results);\n  const pool = useSelector(state => state.pool);\n  const view = useSelector(state => state.view);\n\n  const addResults = (results) => {\n    dispatch({\n      type: 'ADD_RESULT',\n      payload: results\n    });\n  };\n\n  return {\n    stacks,\n    stackCounts,\n    slates,\n    selectedSlate,\n    projection,\n    addResults,\n    results,\n    pool,\n    view\n  };\n};\n\nconst Generator = () => {\n  const {\n    stacks,\n    stackCounts,\n    slates,\n    selectedSlate,\n    projection,\n    addResults,\n    results,\n    pool,\n    view\n  } = getState();\n\n  if (view !== 'generator') {\n    return null;\n  }\n\n  if (!projection || stacks.length === 0) {\n    const issues = [];\n    if (stacks.length === 0) {\n      issues.push((<div>You need to create stacks first</div>))\n    }\n\n    if (!projection) {\n      issues.push((<div>You need to import projections first</div>))\n    }\n\n    return (\n      <div>\n        {issues.map((issue) => (<div>{issue}</div>))}\n      </div>\n    );\n  }\n\n  const slate = slates && slates[selectedSlate]\n  const sport = slate.Sport.toLowerCase();\n  const site = 'draftkings';\n  const type = slate.GameType.Name.toLowerCase();\n\n  const generate = () => {\n    const playersForModel = players.convertPlayers(pool, projection, sport, site, type);\n\n    let n = 0;\n    stackCounts.forEach((count) => {\n      n = n + count;\n    });\n\n    const worker = new Worker();\n\n    stacks.forEach((stack, i) => {\n      const stackPlayers = clone(playersForModel);\n      const model = Models[sport][site][type](stackPlayers);\n      // Force players in stack into lineup\n      stack.forEach((player) => model.constraints[player.draftableId] = { equal: 1 });\n\n      const ownershipOptions = { players: stackPlayers, n: stackCounts[i], stack }\n      worker.postMessage({ action: 'ownership', options: ownershipOptions});\n\n      const enqueueOptions = {\n        action: 'enqueue',\n        n: stackCounts[i],\n        maxIterations: 500,\n        model,\n        players: stackPlayers,\n        sport,\n        site,\n        type\n      };\n      worker.postMessage(enqueueOptions);\n    });\n\n    worker.postMessage({ action: 'solve' });\n    worker.addEventListener('message', (event) => {\n      const results = event.data;\n      if (results.length) {\n        addResults(results);\n      }\n    });\n  };\n\n  const formatPlayer = (draftableId) => {\n    const player = slate.players.find((player) => player.draftableId == draftableId);\n    if (!player) {\n      return draftableId;\n    }\n\n    return `${player.position} - ${player.displayName} - ${player.salary}`;\n  }\n\n  return (\n    <Card>\n      <h2>Generator</h2>\n      <button onClick={generate}>Generateee</button>\n      <ul>\n      {\n        stacks.map((stack, i) => (\n          <li key={i}>Stack with {stackCounts[i]} lineups</li>\n        ))\n      }\n      </ul>\n    </Card>\n  );\n};\n\nexport default Generator;\n"]},"metadata":{},"sourceType":"module"}