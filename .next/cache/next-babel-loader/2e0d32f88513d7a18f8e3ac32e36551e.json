{"ast":null,"code":"import React from \"react\";\nvar __jsx = React.createElement;\nimport Card from './card';\nimport Joi from '@hapi/joi';\nimport { useDispatch, useSelector, shallowEqual } from 'react-redux';\nimport TextField from '@material-ui/core/TextField';\nimport Button from '@material-ui/core/Button';\n\nconst getState = () => {\n  const dispatch = useDispatch();\n  const importErrors = useSelector(state => state.importErrors, shallowEqual);\n  const rawProjection = useSelector(state => state.rawProjection, shallowEqual);\n  const projection = useSelector(state => state.projection, shallowEqual);\n  const view = useSelector(state => state.view);\n\n  const setRawProjection = value => {\n    dispatch({\n      type: 'SET_RAW_PROJECTION',\n      payload: value\n    });\n  };\n\n  const importProjection = () => {\n    dispatch({\n      type: 'CLEAR_IMPORT_ERRORS'\n    });\n\n    if (!rawProjection) {\n      return dispatch({\n        type: 'ADD_IMPORT_ERROR',\n        payload: new Error('empty textarea')\n      });\n    }\n\n    const validationSchema = Joi.object({\n      player: Joi.string().required(),\n      value: Joi.number().required(),\n      ownership: Joi.number().required()\n    }); // track players, they should be unique\n\n    const players = {}; // assumes that values will not contain commas\n\n    let errors = false;\n    const formattedProjection = rawProjection.split('\\n').map(line => {\n      const [player, projection, ownership] = line.indexOf(',') > 0 ? line.split(',') : line.split('\\t');\n      const result = {\n        player,\n        value: Number(projection),\n        ownership: Number(ownership)\n      };\n\n      if (players[player]) {\n        errors = true;\n        dispatch({\n          type: 'ADD_IMPORT_ERROR',\n          payload: new Error(`Duplicate player - ${player}`)\n        });\n      }\n\n      players[player] = true;\n      const validation = validationSchema.validate(result);\n\n      if (validation.error) {\n        errors = true;\n        dispatch({\n          type: 'ADD_IMPORT_ERROR',\n          payload: validation\n        });\n      }\n\n      return result;\n    });\n\n    if (!errors) {\n      dispatch({\n        type: 'SET_PROJECTION',\n        payload: formattedProjection\n      });\n    }\n  };\n\n  return {\n    setRawProjection,\n    projection,\n    importErrors,\n    importProjection,\n    view\n  };\n};\n\nconst componentContainer = {\n  padding: 16\n};\nconst cardContainer = {\n  display: 'flex',\n  flexDirection: 'row'\n};\nconst placeholder = `Copy and paste a csv file of your own projections with desired ownership percentages.  Format each line of your csv like this:\n\nplayer id, projection, desired ownership\n`;\n\nconst ImportProjection = () => {\n  const {\n    importErrors,\n    projection,\n    setRawProjection,\n    importProjection,\n    view\n  } = getState();\n\n  if (view !== 'importprojections') {\n    return null;\n  }\n\n  const onChange = event => setRawProjection(event.target.value);\n\n  const textAreaStyle = {\n    width: 480,\n    padding: 8\n  };\n  const buttonContainerStyle = {\n    paddingBottom: 24\n  };\n  const buttonStyle = {\n    paddingLeft: 36,\n    paddingRight: 36\n  };\n  const infoContainer = {\n    paddingBottom: 36\n  };\n  return __jsx(\"div\", {\n    style: componentContainer\n  }, __jsx(\"h2\", {\n    style: {\n      marginTop: 0\n    }\n  }, \"Your Projections\"), __jsx(\"div\", {\n    style: cardContainer\n  }, __jsx(Card, null, importErrors && !!importErrors.length && __jsx(\"div\", {\n    style: infoContainer\n  }, __jsx(\"h3\", {\n    style: {\n      marginTop: 0\n    }\n  }, \"Import Has Errors\"), __jsx(\"ul\", null, importErrors.map(err => __jsx(\"li\", null, err.error && err.error.toString() || err.toString())))), projection && __jsx(\"div\", {\n    style: infoContainer\n  }, __jsx(\"h3\", {\n    style: {\n      marginTop: 0\n    }\n  }, \"Current Projection\"), __jsx(\"div\", null, `Projections for ${projection.length} players`)), __jsx(\"div\", {\n    style: buttonContainerStyle\n  }, __jsx(Button, {\n    variant: \"contained\",\n    onClick: importProjection,\n    color: \"primary\",\n    style: buttonStyle\n  }, \"Import\")), __jsx(TextField, {\n    id: \"standard-multiline-static\",\n    label: \"Import projections\",\n    multiline: true,\n    rows: \"28\",\n    placeholder: placeholder,\n    variant: \"outlined\",\n    style: textAreaStyle,\n    onChange: onChange\n  }))));\n};\n\nexport default ImportProjection;","map":null,"metadata":{},"sourceType":"module"}