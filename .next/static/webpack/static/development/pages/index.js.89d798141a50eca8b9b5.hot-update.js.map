{"version":3,"file":"static/webpack/static/development/pages/index.js.89d798141a50eca8b9b5.hot-update.js","sources":["webpack:///./components/importprojection.js"],"sourcesContent":["import Card from './card';\nimport Joi from '@hapi/joi';\nimport { useDispatch, useSelector, shallowEqual } from 'react-redux';\nimport TextField from '@material-ui/core/TextField';\nimport Button from '@material-ui/core/Button';\nimport { log } from './utils';\n\nconst getState = () => {\n  const dispatch = useDispatch();\n\n  const importErrors = useSelector(state => state.importErrors, shallowEqual);\n  const rawProjection = useSelector(state => state.rawProjection, shallowEqual);\n  const projection = useSelector(state => state.projection, shallowEqual);\n  const view = useSelector(state => state.view, shallowEqual);\n  const slates = useSelector(state => state.slates, shallowEqual);\n  const selectedSlate = useSelector(state => state.selectedSlate, shallowEqual);\n\n  const setRawProjection = (value) => {\n    dispatch({\n      type: 'SET_RAW_PROJECTION',\n      payload: value\n    });\n  };\n\n  const importProjection = () => {\n    log('import');\n\n    dispatch({ type: 'CLEAR_IMPORT_ERRORS' });\n\n    if (!rawProjection) {\n      log('import error empty textarea')\n      return dispatch({\n        type: 'ADD_IMPORT_ERROR',\n        payload: new Error('empty textarea')\n      });\n    }\n\n    const validationSchema = Joi.object({\n      player: Joi.string().required(),\n      value: Joi.number().required(),\n      ownership: Joi.number().required()\n    });\n\n    // track players, they should be unique\n    const players = {};\n\n    // assumes that values will not contain commas\n    let errors = false;\n    const formattedProjection = rawProjection.split('\\n').map((line) => {\n      const [player, projection, ownership] = line.indexOf(',') > 0 ? line.split(',') : line.split('\\t');\n\n      if (player === 'ID' || player === '') {\n        return 'REMOVE';\n      }\n\n      const result = {\n        player,\n        value: Number(projection),\n        ownership: Number(ownership)\n      };\n\n      if (players[player]) {\n        errors = true;\n        log('import error duplicate player')\n        dispatch({\n          type: 'ADD_IMPORT_ERROR',\n          payload: new Error(`Duplicate player - ${player}`)\n        });\n      }\n\n      players[player] = true;\n\n      const validation = validationSchema.validate(result);\n      if (validation.error) {\n        errors = true;\n        log('import error validation error')\n        dispatch({\n          type: 'ADD_IMPORT_ERROR',\n          payload: validation\n        });\n      }\n\n      return result;\n    }).filter((result) => result !== 'REMOVE');\n\n    if (!errors) {\n      log(`import ${formattedProjection.length} records`)\n      dispatch({\n        type: 'SET_PROJECTION',\n        payload: formattedProjection\n      });\n    }\n  };\n\n  const exportTemplate = () => {\n    if (slates && selectedSlate) {\n      log(`export template`)\n      const { players } = slates[selectedSlate];\n      const format = (player) => {\n        return `${player.displayName},${player.draftableId},,50`;\n      };\n      const header = \"Do not copy the player name column as well as this row\\nName,ID,Projection,Ownership\\n\"\n      const csv = \"data:text/csv;charset=utf-8,\" + header + players.map(format).join('\\n');\n\n      const { encodeURI } = window;\n      const { createElement, body } = document\n\n      const downloadLink = document.createElement(\"a\");\n      downloadLink.href = encodeURI(csv);\n      downloadLink.download = `${selectedSlate} - Projections.csv`;\n      body.appendChild(downloadLink);\n      downloadLink.click();\n      body.removeChild(downloadLink);\n    }\n  };\n\n  return {\n    setRawProjection,\n    projection,\n    importErrors,\n    importProjection,\n    view,\n    exportTemplate\n  };\n};\n\nconst componentContainer = {\n  padding: 16\n};\n\nconst cardContainer = {\n  display: 'flex',\n  flexDirection: 'row'\n};\n\nconst placeholder = `Copy and paste a csv or tab deliminated file of your own projections with desired ownership percentages.  Format each line of your csv like this:\n\nplayer id, projection, desired ownership\n\nor for a tab deliminated file, like this:\nplayer id projection  desired ownership\n`;\n\nconst ImportProjection  = () => {\n\n  const { importErrors, projection, setRawProjection, importProjection, view, exportTemplate } = getState();\n\n  if (view !== 'importprojections') {\n    return null;\n  }\n\n  const onChange = (event) => setRawProjection(event.target.value);\n\n  const textAreaStyle = {\n    width: 480,\n    padding: 8\n  };\n\n  const buttonsContainerStyle = {\n    display: 'flex',\n    flexDirection: 'row',\n    paddingBottom: 24\n  };\n\n  const buttonContainerStyle = {\n    paddingRight: 24\n  }\n\n  const buttonStyle = {\n    paddingLeft: 36,\n    paddingRight: 36\n  };\n\n  const infoContainer = {\n    paddingBottom: 36\n  };\n\n  return (\n    <div style={componentContainer}>\n      <h2 style={{ marginTop: 0 }}>Your Projections</h2>\n      <div style={cardContainer}>\n        <Card>\n          { !projection && (\n            <div style={infoContainer}>\n              DFS Solver is a Bring Your Own Projection system.  You'll need to copy and paste your projections into the text area below.\n              Use the Export Template button to download a sheet with proper player id's for your selected slate.\n            </div>\n          )}\n          {importErrors && !!importErrors.length && (\n            <div style={infoContainer}>\n              <h3 style={{ marginTop: 0 }}>Import Has Errors</h3>\n              <ul>\n                {importErrors.map((err) => (\n                  <li>{(err.error && err.error.toString()) || err.toString()}</li>\n                ))}\n              </ul>\n            </div>\n          )}\n          {\n            projection && (\n              <div style={infoContainer}>\n                <h3 style={{ marginTop: 0 }}>Current Projection</h3>\n                <div>\n                  {`Projections for ${projection.length} players`}\n                  {\n                    //projection.map((projection) => (<li>{projection.player} - {projection.value}</li>))\n                  }\n                </div>\n              </div>\n            )\n          }\n          <div style={buttonsContainerStyle}>\n            <div style={buttonContainerStyle}>\n              <Button variant=\"contained\" onClick={importProjection} color=\"primary\" style={buttonStyle}>Import Projections</Button>\n            </div>\n            <div style={buttonContainerStyle}>\n              <Button variant=\"contained\" onClick={exportTemplate} color=\"secondary\" style={buttonStyle}>Export Template</Button>\n            </div>\n          </div>\n          <TextField\n            id=\"standard-multiline-static\"\n            label=\"Import projections\"\n            multiline\n            rows=\"28\"\n            placeholder={placeholder}\n            variant=\"outlined\"\n            style={textAreaStyle}\n            onChange={onChange}\n          />\n        </Card>\n      </div>\n    </div>\n  )\n};\n\nexport default ImportProjection;\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AAFA;AAIA;AACA;AACA;AACA;AAEA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAFA;AAIA;AACA;AACA;AACA;AACA;AACA;AAHA;AACA;AAMA;AACA;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAHA;AACA;AAKA;AACA;AACA;AACA;AACA;AACA;AAFA;AAIA;AACA;AACA;AAEA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAFA;AAIA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAFA;AAIA;AACA;AACA;AACA;AACA;AACA;AADA;AACA;AAEA;AACA;AACA;AACA;AAAA;AACA;AAPA;AAAA;AAAA;AAAA;AAAA;AAYA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AANA;AAQA;AACA;AACA;AACA;AADA;AAIA;AACA;AACA;AAFA;AAKA;AACA;AAOA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAGA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AAFA;AAKA;AACA;AACA;AACA;AAHA;AAMA;AACA;AADA;AAIA;AACA;AACA;AAFA;AAKA;AACA;AADA;AAIA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAMA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AADA;AAQA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AASA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AARA;AAAA;AAAA;AAAA;AAAA;AAAA;AAcA;AACA;AACA;;;;A","sourceRoot":""}